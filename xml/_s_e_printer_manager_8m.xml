<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.9.1">
  <compounddef id="_s_e_printer_manager_8m" kind="file" language="Objective-C">
    <compoundname>SEPrinterManager.m</compoundname>
    <includes refid="_s_e_printer_manager_8h" local="yes">SEPrinterManager.h</includes>
    <incdepgraph>
      <node id="51">
        <label>SEPrinterManager.h</label>
        <link refid="_s_e_printer_manager_8h"/>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="53" relation="include">
        </childnode>
        <childnode refid="54" relation="include">
        </childnode>
        <childnode refid="55" relation="include">
        </childnode>
      </node>
      <node id="53">
        <label>CoreBluetooth/CoreBluetooth.h</label>
      </node>
      <node id="50">
        <label>XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m</label>
        <link refid="SEPrinterManager.m"/>
        <childnode refid="51" relation="include">
        </childnode>
      </node>
      <node id="56">
        <label>UIKit/UIKit.h</label>
      </node>
      <node id="55">
        <label>HLPrinter.h</label>
        <link refid="_h_l_printer_8h"/>
        <childnode refid="52" relation="include">
        </childnode>
        <childnode refid="56" relation="include">
        </childnode>
        <childnode refid="57" relation="include">
        </childnode>
      </node>
      <node id="57">
        <label>UIImage+Bitmap.h</label>
        <link refid="_u_i_image_09_bitmap_8h"/>
        <childnode refid="56" relation="include">
        </childnode>
      </node>
      <node id="52">
        <label>Foundation/Foundation.h</label>
      </node>
      <node id="54">
        <label>SEBLEConst.h</label>
        <link refid="_s_e_b_l_e_const_8h"/>
      </node>
    </incdepgraph>
    <innerclass refid="category_s_e_printer_manager_07_08" prot="public">SEPrinterManager()</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="_s_e_printer_manager_8m_1a059728dbdb3a9360cf3307e75d3296d5" prot="public" static="no">
        <name>kSECharacter</name>
        <initializer>@&quot;character&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/suxinde/XDCommonLib/XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m" line="11" column="9" bodyfile="/Users/suxinde/XDCommonLib/XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m" bodystart="11" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_s_e_printer_manager_8m_1a00e77f56ab5fdd804c8e8fa85013e1b5" prot="public" static="no">
        <name>kSEType</name>
        <initializer>@&quot;type&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/suxinde/XDCommonLib/XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m" line="12" column="9" bodyfile="/Users/suxinde/XDCommonLib/XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m" bodystart="12" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_s_e_printer_manager_8m_1a69f7e1dd24bead069e9429b4c386c3a7" prot="public" static="yes" mutable="no">
        <type><ref refid="class_s_e_printer_manager" kindref="compound">SEPrinterManager</ref> *</type>
        <definition>SEPrinterManager* instance</definition>
        <argsstring></argsstring>
        <name>instance</name>
        <initializer>= nil</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/suxinde/XDCommonLib/XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m" line="37" column="1" bodyfile="/Users/suxinde/XDCommonLib/XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m" bodystart="37" bodyend="-1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>SEPrinterManager.m</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>SEBLEPrinter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>Created<sp/>by<sp/>Harvey<sp/>on<sp/>16/5/5.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>Copyright<sp/>©<sp/>2016年<sp/>Halley.<sp/>All<sp/>rights<sp/>reserved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#import<sp/>&quot;<ref refid="_s_e_printer_manager_8h" kindref="compound">SEPrinterManager.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11" refid="_s_e_printer_manager_8m_1a059728dbdb3a9360cf3307e75d3296d5" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>kSECharacter<sp/><sp/><sp/><sp/>@&quot;character&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12" refid="_s_e_printer_manager_8m_1a00e77f56ab5fdd804c8e8fa85013e1b5" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>kSEType<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>@&quot;type&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14" refid="category_s_e_printer_manager_07_08" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">@interface<sp/></highlight><highlight class="normal"><ref refid="class_s_e_printer_manager" kindref="compound">SEPrinterManager</ref><sp/>()&lt;CBCentralManagerDelegate,CBPeripheralDelegate&gt;</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="category_s_e_printer_manager_07_08_1a90e09f28f4eaaccfc225b3cc1bcfae76" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(copy,<sp/>nonatomic)<sp/><sp/><sp/><ref refid="_s_e_b_l_e_const_8h_1a6294aed3adb28e9b4347144f40aa16e5" kindref="member">SEScanPerpheralSuccess</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scanPerpheralSuccess;<sp/><sp/></highlight></codeline>
<codeline lineno="17" refid="category_s_e_printer_manager_07_08_1afb11fb483d6fbd4d8d96f6f38c537b23" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(copy,<sp/>nonatomic)<sp/><sp/><sp/><ref refid="_s_e_b_l_e_const_8h_1a35b5090ce2cf242ac80a3b90674e2ee4" kindref="member">SEScanPerpheralFailure</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scanPerpheralFailure;<sp/><sp/></highlight></codeline>
<codeline lineno="18" refid="category_s_e_printer_manager_07_08_1a14ab4db534aeb0cc7cdf677585d10c85" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(copy,<sp/>nonatomic)<sp/><sp/><sp/><ref refid="_s_e_b_l_e_const_8h_1ad57a5ae761ace96bba403778810efb65" kindref="member">SEConnectCompletion</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>connectCompletion;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="19" refid="category_s_e_printer_manager_07_08_1a268a1b9ea3bc53d29a9d9b24400bd6a4" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(copy,<sp/>nonatomic)<sp/><sp/><sp/><ref refid="_s_e_b_l_e_const_8h_1a5194a49f52044a6a9ef61e3e40b7a106" kindref="member">SEFullOptionCompletion</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>optionCompletion;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="21" refid="category_s_e_printer_manager_07_08_1a2f5a9e84bb71d016aec7403325a67e37" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(copy,<sp/>nonatomic)<sp/><sp/><sp/><ref refid="_s_e_b_l_e_const_8h_1a046dc386ce14d28a5b3871cdc80a211e" kindref="member">SEDisconnect</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disconnectBlock;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="23" refid="category_s_e_printer_manager_07_08_1af0ffd1104333d2de5f644ee3f492426b" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/><sp/><sp/>CBCentralManager<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*centralManager;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="24" refid="category_s_e_printer_manager_07_08_1a575795e29d2154fea5c050e9939c67bf" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/><sp/><sp/>CBPeripheral<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*connectedPerpheral;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="25" refid="category_s_e_printer_manager_07_08_1a0b12b1ff136b2c14adf8848c69c796a9" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/><sp/><sp/>NSMutableArray<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*perpherals;<sp/><sp/></highlight></codeline>
<codeline lineno="27" refid="category_s_e_printer_manager_07_08_1ae532111dcd7749e84206d2eb370a4959" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/><sp/><sp/>NSMutableArray<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*writeChatacters;<sp/><sp/></highlight></codeline>
<codeline lineno="29" refid="category_s_e_printer_manager_07_08_1a51d143e909c54ae6d0a6289a935ddb60" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(assign,<sp/>nonatomic)<sp/><sp/><sp/>NSTimeInterval<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeout;<sp/><sp/></highlight></codeline>
<codeline lineno="31" refid="category_s_e_printer_manager_07_08_1a602458c132dd4da7fced12210b1202c4" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(strong,<sp/>nonatomic)<sp/><sp/><sp/><ref refid="class_h_l_printer" kindref="compound">HLPrinter</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*printer;<sp/><sp/></highlight></codeline>
<codeline lineno="33" refid="category_s_e_printer_manager_07_08_1a7d60f9602db43be6578646e0fc738334" refkind="member"><highlight class="keyword">@property</highlight><highlight class="normal"><sp/>(assign,<sp/>nonatomic)<sp/><sp/><sp/>BOOL<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>autoConnect;<sp/><sp/></highlight></codeline>
<codeline lineno="35"><highlight class="keyword">@end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="class_s_e_printer_manager" kindref="compound">SEPrinterManager</ref><sp/>*instance<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="class_s_e_printer_manager" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">@implementation<sp/></highlight><highlight class="normal"><ref refid="class_s_e_printer_manager" kindref="compound">SEPrinterManager</ref></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="class_s_e_printer_manager_1a296c9f74b83aee537a266f6ce50d6453" refkind="member"><highlight class="normal">+<sp/>(instancetype)<ref refid="class_s_e_printer_manager_1a296c9f74b83aee537a266f6ce50d6453" kindref="member">sharedInstance</ref></highlight></codeline>
<codeline lineno="42"><highlight class="normal">{</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>alloc]<sp/>init];</highlight></codeline>
<codeline lineno="44"><highlight class="normal">}</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46" refid="class_s_e_printer_manager_1af684d1409f68a8a2bd3a609dbc7c66ae" refkind="member"><highlight class="normal">+<sp/>(NSString<sp/>*)<ref refid="class_s_e_printer_manager_1af684d1409f68a8a2bd3a609dbc7c66ae" kindref="member">UUIDStringForLastPeripheral</ref></highlight></codeline>
<codeline lineno="47"><highlight class="normal">{</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>NSUserDefaults<sp/>*userDefaults<sp/>=<sp/>[NSUserDefaults<sp/>standardUserDefaults];</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/>NSString<sp/>*UUIDString<sp/>=<sp/>[userDefaults<sp/>objectForKey:@&quot;peripheral&quot;];</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>UUIDString;</highlight></codeline>
<codeline lineno="51"><highlight class="normal">}</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal">-<sp/>(instancetype)init</highlight></codeline>
<codeline lineno="54"><highlight class="normal">{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>dispatch_once_t<sp/>onceToken;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>dispatch_once(&amp;onceToken,<sp/>^{</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>=<sp/>[</highlight><highlight class="keyword">super</highlight><highlight class="normal"><sp/>init];</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance.perpherals<sp/>=<sp/>[[NSMutableArray<sp/>alloc]<sp/>init];</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance.writeChatacters<sp/>=<sp/>[[NSMutableArray<sp/>alloc]<sp/>init];</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance.timeout<sp/>=<sp/>30;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>instance;</highlight></codeline>
<codeline lineno="63"><highlight class="normal">}</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal">+<sp/>(instancetype)allocWithZone:(struct<sp/>_NSZone<sp/>*)zone</highlight></codeline>
<codeline lineno="66"><highlight class="normal">{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>dispatch_once_t<sp/>onceToken;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>dispatch_once(&amp;onceToken,<sp/>^{</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>instance<sp/>=<sp/>[</highlight><highlight class="keyword">super</highlight><highlight class="normal"><sp/>allocWithZone:zone];</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>instance;</highlight></codeline>
<codeline lineno="73"><highlight class="normal">}</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>mark<sp/>-<sp/>bluetooth<sp/>method</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal">-<sp/>(void)setTimeout:(NSTimeInterval)timeout</highlight></codeline>
<codeline lineno="77"><highlight class="normal">{</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>_timeout<sp/>=<sp/>timeout;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_timeout<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>performSelector:@selector(timeoutAction)<sp/>withObject:nil<sp/>afterDelay:timeout];</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="83"><highlight class="normal">}</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal">-<sp/>(void)timeoutAction</highlight></codeline>
<codeline lineno="86"><highlight class="normal">{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/>[_centralManager<sp/>stopScan];</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_perpherals.count<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//分发错误信息</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_delegate<sp/>&amp;&amp;<sp/>[_delegate<sp/>respondsToSelector:</highlight><highlight class="keyword">@selector</highlight><highlight class="normal">(printerManager:scanError:)])<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_delegate<sp/>printerManager:self<sp/>scanError:SEScanErrorTimeout];</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_scanPerpheralFailure)<sp/>{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_scanPerpheralFailure(SEScanErrorTimeout);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_delegate<sp/>&amp;&amp;<sp/>[_delegate<sp/>respondsToSelector:</highlight><highlight class="keyword">@selector</highlight><highlight class="normal">(printerManager:perpherals:isTimeout:)])<sp/>{</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_delegate<sp/>printerManager:self<sp/>perpherals:_perpherals<sp/>isTimeout:YES];</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_scanPerpheralSuccess)<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_scanPerpheralSuccess(_perpherals,YES);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal">}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107" refid="class_s_e_printer_manager_1a2fcee5fc533abfb1f1ebaea665696ae6" refkind="member"><highlight class="normal">-<sp/>(BOOL)<ref refid="class_s_e_printer_manager_1a2fcee5fc533abfb1f1ebaea665696ae6" kindref="member">isConnected</ref></highlight></codeline>
<codeline lineno="108"><highlight class="normal">{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!_connectedPerpheral)<sp/>{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NO;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_connectedPerpheral.state<sp/>!=<sp/>CBPeripheralStateConnected<sp/>&amp;&amp;<sp/>_connectedPerpheral.state<sp/>!=<sp/>CBPeripheralStateConnecting)<sp/>{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NO;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>YES;</highlight></codeline>
<codeline lineno="118"><highlight class="normal">}</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal">-<sp/>(void)resetBLEModel</highlight></codeline>
<codeline lineno="121"><highlight class="normal">{</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>_centralManager<sp/>=<sp/>[[CBCentralManager<sp/>alloc]<sp/>initWithDelegate:self<sp/>queue:dispatch_get_main_queue()];</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>[_perpherals<sp/>removeAllObjects];</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>_connectedPerpheral<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="125"><highlight class="normal">}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127" refid="class_s_e_printer_manager_1aef666121bbffaf0cd3ce0935756c29b4" refkind="member"><highlight class="normal">-<sp/>(void)startScanPerpheralTimeout:(NSTimeInterval)timeout</highlight></codeline>
<codeline lineno="128"><highlight class="normal">{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">.timeout<sp/>=<sp/>timeout;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_centralManager.state<sp/>==<sp/>CBCentralManagerStatePoweredOn)<sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_centralManager<sp/>scanForPeripheralsWithServices:nil<sp/>options:nil];</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>resetBLEModel];</highlight></codeline>
<codeline lineno="136"><highlight class="normal">}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138" refid="class_s_e_printer_manager_1a12ec574755e01f7bffb8584057840320" refkind="member"><highlight class="normal">-<sp/>(void)startScanPerpheralTimeout:(NSTimeInterval)timeout<sp/>Success:(<ref refid="_s_e_b_l_e_const_8h_1a6294aed3adb28e9b4347144f40aa16e5" kindref="member">SEScanPerpheralSuccess</ref>)success<sp/>failure:(<ref refid="_s_e_b_l_e_const_8h_1a35b5090ce2cf242ac80a3b90674e2ee4" kindref="member">SEScanPerpheralFailure</ref>)failure</highlight></codeline>
<codeline lineno="139"><highlight class="normal">{</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">.timeout<sp/>=<sp/>timeout;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/>_scanPerpheralSuccess<sp/>=<sp/>success;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>_scanPerpheralFailure<sp/>=<sp/>failure;</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_centralManager.state<sp/>==<sp/>CBCentralManagerStatePoweredOn)<sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_centralManager<sp/>scanForPeripheralsWithServices:nil<sp/>options:nil];</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/>resetBLEModel];</highlight></codeline>
<codeline lineno="150"><highlight class="normal">}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152" refid="class_s_e_printer_manager_1a2533fdfabc67e03d6bd0c25a3cd780ef" refkind="member"><highlight class="normal">-<sp/>(void)<ref refid="class_s_e_printer_manager_1a2533fdfabc67e03d6bd0c25a3cd780ef" kindref="member">stopScan</ref></highlight></codeline>
<codeline lineno="153"><highlight class="normal">{</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>[_centralManager<sp/>stopScan];</highlight></codeline>
<codeline lineno="155"><highlight class="normal">}</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157" refid="class_s_e_printer_manager_1afa573e0034568b3e70a7ee24f3fc7f19" refkind="member"><highlight class="normal">-<sp/>(void)connectPeripheral:(CBPeripheral<sp/>*)peripheral</highlight></codeline>
<codeline lineno="158"><highlight class="normal">{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>[_centralManager<sp/>connectPeripheral:peripheral<sp/>options:nil];</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>peripheral.delegate<sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="161"><highlight class="normal">}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163" refid="class_s_e_printer_manager_1a8bf3d9ac69a62dce171e96cebca9bfb1" refkind="member"><highlight class="normal">-<sp/>(void)connectPeripheral:(CBPeripheral<sp/>*)peripheral<sp/>completion:(<ref refid="_s_e_b_l_e_const_8h_1ad57a5ae761ace96bba403778810efb65" kindref="member">SEConnectCompletion</ref>)completion</highlight></codeline>
<codeline lineno="164"><highlight class="normal">{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>_connectCompletion<sp/>=<sp/>completion;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/><ref refid="class_s_e_printer_manager_1afa573e0034568b3e70a7ee24f3fc7f19" kindref="member">connectPeripheral</ref>:peripheral];</highlight></codeline>
<codeline lineno="167"><highlight class="normal">}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169" refid="class_s_e_printer_manager_1a8f5697196f94ec8ece4a5b7f43bc1aa7" refkind="member"><highlight class="normal">-<sp/>(void)fullOptionPeripheral:(CBPeripheral<sp/>*)peripheral<sp/>completion:(<ref refid="_s_e_b_l_e_const_8h_1a5194a49f52044a6a9ef61e3e40b7a106" kindref="member">SEFullOptionCompletion</ref>)completion</highlight></codeline>
<codeline lineno="170"><highlight class="normal">{</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/>_optionCompletion<sp/>=<sp/>completion;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/><ref refid="class_s_e_printer_manager_1afa573e0034568b3e70a7ee24f3fc7f19" kindref="member">connectPeripheral</ref>:peripheral];</highlight></codeline>
<codeline lineno="173"><highlight class="normal">}</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175" refid="class_s_e_printer_manager_1a2acb2cab0103380da0ed118f928e9e59" refkind="member"><highlight class="normal">-<sp/>(void)cancelPeripheral:(CBPeripheral<sp/>*)peripheral</highlight></codeline>
<codeline lineno="176"><highlight class="normal">{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!peripheral)<sp/>{</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>[_centralManager<sp/>cancelPeripheralConnection:peripheral];</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>_connectedPerpheral<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>[_writeChatacters<sp/>removeAllObjects];</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>NSUserDefaults<sp/>*userDefaults<sp/>=<sp/>[NSUserDefaults<sp/>standardUserDefaults];</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>[userDefaults<sp/>removeObjectForKey:@&quot;peripheral&quot;];</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>[userDefaults<sp/>synchronize];</highlight></codeline>
<codeline lineno="187"><highlight class="normal">}</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189" refid="class_s_e_printer_manager_1a7d9963de1620a0fd6f9dbfeb51b48e32" refkind="member"><highlight class="normal">-<sp/>(void)autoConnectLastPeripheralTimeout:(NSTimeInterval)timeout<sp/>completion:(<ref refid="_s_e_b_l_e_const_8h_1ad57a5ae761ace96bba403778810efb65" kindref="member">SEConnectCompletion</ref>)completion</highlight></codeline>
<codeline lineno="190"><highlight class="normal">{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/>_autoConnect<sp/>=<sp/>YES;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/>_connectCompletion<sp/>=<sp/>completion;</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>[_centralManager<sp/>scanForPeripheralsWithServices:nil<sp/>options:nil];</highlight></codeline>
<codeline lineno="196"><highlight class="normal">}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198" refid="class_s_e_printer_manager_1aa1a4ef1ebbb59d38756be3d091aede1c" refkind="member"><highlight class="normal">-<sp/>(void)setDisconnect:(<ref refid="_s_e_b_l_e_const_8h_1a046dc386ce14d28a5b3871cdc80a211e" kindref="member">SEDisconnect</ref>)disconnectBlock</highlight></codeline>
<codeline lineno="199"><highlight class="normal">{</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>_disconnectBlock<sp/>=<sp/>disconnectBlock;</highlight></codeline>
<codeline lineno="201"><highlight class="normal">}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203" refid="class_s_e_printer_manager_1a5825d0b66d06e92a5ce6c6a554b03b80" refkind="member"><highlight class="normal">-<sp/>(void)sendPrintData:(NSData<sp/>*)data<sp/>completion:(<ref refid="_s_e_b_l_e_const_8h_1af0de0049e32d151120cc9943db0010a7" kindref="member">SEPrintResult</ref>)result</highlight></codeline>
<codeline lineno="204"><highlight class="normal">{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!</highlight><highlight class="keyword">self</highlight><highlight class="normal">.connectedPerpheral)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result)<sp/>{</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(_connectedPerpheral,NO,</highlight><highlight class="stringliteral">@&quot;未连接蓝牙设备&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">self</highlight><highlight class="normal">.writeChatacters.count<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result)<sp/>{</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(_connectedPerpheral,NO,</highlight><highlight class="stringliteral">@&quot;该蓝牙设备不能写入数据&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/>NSDictionary<sp/>*dict<sp/>=<sp/>[_writeChatacters<sp/>firstObject];</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/>[_connectedPerpheral<sp/>writeValue:data<sp/>forCharacteristic:dict[kSECharacter]<sp/>type:[dict[kSEType]<sp/>integerValue]];</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result)<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(_connectedPerpheral,YES,</highlight><highlight class="stringliteral">@&quot;已成功发送至蓝牙设备&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="225"><highlight class="normal">}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227" refid="class_s_e_printer_manager_1a750f01d7f6d5e1a36ba8b5c7d91a675d" refkind="member"><highlight class="normal">-<sp/>(void)printWithResult:(<ref refid="_s_e_b_l_e_const_8h_1af0de0049e32d151120cc9943db0010a7" kindref="member">SEPrintResult</ref>)result</highlight></codeline>
<codeline lineno="228"><highlight class="normal">{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/>NSData<sp/>*finalData<sp/>=<sp/>[_printer<sp/>getFinalData];</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(finalData.length<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result)<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result(_connectedPerpheral,NO,</highlight><highlight class="stringliteral">@&quot;打印数据格式出错&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>[</highlight><highlight class="keyword">self</highlight><highlight class="normal"><sp/><ref refid="class_s_e_printer_manager_1a5825d0b66d06e92a5ce6c6a554b03b80" kindref="member">sendPrintData</ref>:finalData<sp/><ref refid="class_s_e_printer_manager_1a5825d0b66d06e92a5ce6c6a554b03b80" kindref="member">completion</ref>:result];</highlight></codeline>
<codeline lineno="238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>mark<sp/>-<sp/>------------print<sp/>method<sp/>----------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241" refid="class_s_e_printer_manager_1ac0cf6330be2c382bcacbfa24ebe3045b" refkind="member"><highlight class="normal">-<sp/>(void)<ref refid="class_s_e_printer_manager_1ac0cf6330be2c382bcacbfa24ebe3045b" kindref="member">prepareForPrinter</ref></highlight></codeline>
<codeline lineno="242"><highlight class="normal">{</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_h_l_printer" kindref="compound">HLPrinter</ref><sp/>*printer<sp/>=<sp/>[[<ref refid="class_h_l_printer" kindref="compound">HLPrinter</ref><sp/>alloc]<sp/>init];</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/>_printer<sp/>=<sp/>printer;</highlight></codeline>
<codeline lineno="245"><highlight class="normal">}</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="253" refid="class_s_e_printer_manager_1a2aa1ef7fca7e9b68762e64cf46b501ae" refkind="member"><highlight class="normal">-<sp/>(void)appendText:(NSString<sp/>*)text<sp/>alignment:(HLTextAlignment)alignment</highlight></codeline>
<codeline lineno="254"><highlight class="normal">{</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendText:text<sp/>alignment:alignment];</highlight></codeline>
<codeline lineno="256"><highlight class="normal">}</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="265" refid="class_s_e_printer_manager_1a4fa3f803055b649435215d7af6b5df81" refkind="member"><highlight class="normal">-<sp/>(void)appendText:(NSString<sp/>*)text<sp/>alignment:(HLTextAlignment)alignment<sp/>fontSize:(HLFontSize)fontSize</highlight></codeline>
<codeline lineno="266"><highlight class="normal">{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendText:text<sp/>alignment:alignment<sp/>fontSize:fontSize];</highlight></codeline>
<codeline lineno="268"><highlight class="normal">}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="276" refid="class_s_e_printer_manager_1ad817f03436dec5035892cc00dfa12344" refkind="member"><highlight class="normal">-<sp/>(void)appendTitle:(NSString<sp/>*)title<sp/>value:(NSString<sp/>*)value</highlight></codeline>
<codeline lineno="277"><highlight class="normal">{</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendTitle:title<sp/>value:value];</highlight></codeline>
<codeline lineno="279"><highlight class="normal">}</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="288" refid="class_s_e_printer_manager_1a13f5dbe90e7a2a793cc10c6974674f49" refkind="member"><highlight class="normal">-<sp/>(void)appendTitle:(NSString<sp/>*)title<sp/>value:(NSString<sp/>*)value<sp/>fontSize:(HLFontSize)fontSize</highlight></codeline>
<codeline lineno="289"><highlight class="normal">{</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendTitle:title<sp/>value:value<sp/>fontSize:fontSize];</highlight></codeline>
<codeline lineno="291"><highlight class="normal">}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="300" refid="class_s_e_printer_manager_1a9d3d7a3f712007195f6097af1f63b429" refkind="member"><highlight class="normal">-<sp/>(void)appendTitle:(NSString<sp/>*)title<sp/>value:(NSString<sp/>*)value<sp/>valueOffset:(NSInteger)offset</highlight></codeline>
<codeline lineno="301"><highlight class="normal">{</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendTitle:title<sp/>value:value<sp/>valueOffset:offset];</highlight></codeline>
<codeline lineno="303"><highlight class="normal">}</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="313" refid="class_s_e_printer_manager_1a4f078ce58200e23efdd9218601fddb97" refkind="member"><highlight class="normal">-<sp/>(void)appendTitle:(NSString<sp/>*)title<sp/>value:(NSString<sp/>*)value<sp/>valueOffset:(NSInteger)offset<sp/>fontSize:(HLFontSize)fontSize</highlight></codeline>
<codeline lineno="314"><highlight class="normal">{</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendTitle:title<sp/>value:value<sp/>valueOffset:offset<sp/>fontSize:fontSize];</highlight></codeline>
<codeline lineno="316"><highlight class="normal">}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="325" refid="class_s_e_printer_manager_1aa6063e72c86263f0ce8b356c3e154d37" refkind="member"><highlight class="normal">-<sp/>(void)appendLeftText:(NSString<sp/>*)left<sp/>middleText:(NSString<sp/>*)middle<sp/>rightText:(NSString<sp/>*)right<sp/>isTitle:(BOOL)isTitle</highlight></codeline>
<codeline lineno="326"><highlight class="normal">{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendLeftText:left<sp/>middleText:middle<sp/>rightText:right<sp/>isTitle:isTitle];</highlight></codeline>
<codeline lineno="328"><highlight class="normal">}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="337" refid="class_s_e_printer_manager_1a2f312474afad1470b3c3bf548684d974" refkind="member"><highlight class="normal">-<sp/>(void)appendImage:(UIImage<sp/>*)image<sp/>alignment:(HLTextAlignment)alignment<sp/>maxWidth:(CGFloat)maxWidth</highlight></codeline>
<codeline lineno="338"><highlight class="normal">{</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendImage:image<sp/>alignment:alignment<sp/>maxWidth:maxWidth];</highlight></codeline>
<codeline lineno="340"><highlight class="normal">}</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="347" refid="class_s_e_printer_manager_1ab851c06ec1b31925f69ef951426f04be" refkind="member"><highlight class="normal">-<sp/>(void)appendBarCodeWithInfo:(NSString<sp/>*)info</highlight></codeline>
<codeline lineno="348"><highlight class="normal">{</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendBarCodeWithInfo:info];</highlight></codeline>
<codeline lineno="350"><highlight class="normal">}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="359" refid="class_s_e_printer_manager_1a07340be91342d2f2053a8bf6f67c5547" refkind="member"><highlight class="normal">-<sp/>(void)appendBarCodeWithInfo:(NSString<sp/>*)info<sp/>alignment:(HLTextAlignment)alignment<sp/>maxWidth:(CGFloat)maxWidth</highlight></codeline>
<codeline lineno="360"><highlight class="normal">{</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendBarCodeWithInfo:info<sp/>alignment:alignment<sp/>maxWidth:maxWidth];</highlight></codeline>
<codeline lineno="362"><highlight class="normal">}</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="369" refid="class_s_e_printer_manager_1a3e39765940cb0814f6d67a656cc467d8" refkind="member"><highlight class="normal">-<sp/>(void)appendQRCodeWithInfo:(NSString<sp/>*)info</highlight></codeline>
<codeline lineno="370"><highlight class="normal">{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendQRCodeWithInfo:info];</highlight></codeline>
<codeline lineno="372"><highlight class="normal">}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="382" refid="class_s_e_printer_manager_1a4aa163bae4c2d2467b8247d01d003063" refkind="member"><highlight class="normal">-<sp/>(void)appendQRCodeWithInfo:(NSString<sp/>*)info<sp/>centerImage:(UIImage<sp/>*)centerImage<sp/>alignment:(HLTextAlignment)alignment<sp/>maxWidth:(CGFloat<sp/>)maxWidth</highlight></codeline>
<codeline lineno="383"><highlight class="normal">{</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendQRCodeWithInfo:info<sp/>centerImage:centerImage<sp/>alignment:alignment<sp/>maxWidth:maxWidth];</highlight></codeline>
<codeline lineno="385"><highlight class="normal">}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="390" refid="class_s_e_printer_manager_1a9975eae0f2ee513359c9c4db40a5a12f" refkind="member"><highlight class="normal">-<sp/>(void)<ref refid="class_s_e_printer_manager_1a9975eae0f2ee513359c9c4db40a5a12f" kindref="member">appendSeperatorLine</ref></highlight></codeline>
<codeline lineno="391"><highlight class="normal">{</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendSeperatorLine];</highlight></codeline>
<codeline lineno="393"><highlight class="normal">}</highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight></codeline>
<codeline lineno="400" refid="class_s_e_printer_manager_1a98d76706e68cb4160ea6b379d634559d" refkind="member"><highlight class="normal">-<sp/>(void)appendFooter:(NSString<sp/>*)footerInfo</highlight></codeline>
<codeline lineno="401"><highlight class="normal">{</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>[_printer<sp/>appendFooter:footerInfo];</highlight></codeline>
<codeline lineno="403"><highlight class="normal">}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>mark<sp/>-<sp/>CBCentralManagerDelegate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal">-<sp/>(void)centralManagerDidUpdateState:(CBCentralManager<sp/>*)central</highlight></codeline>
<codeline lineno="407"><highlight class="normal">{</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(central.state<sp/>!=<sp/>CBCentralManagerStatePoweredOn)<sp/>{</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_delegate<sp/>&amp;&amp;<sp/>[_delegate<sp/>respondsToSelector:</highlight><highlight class="keyword">@selector</highlight><highlight class="normal">(printerManager:scanError:)])<sp/>{</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_delegate<sp/>printerManager:self<sp/>scanError:(SEScanError)central.state];</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_scanPerpheralFailure)<sp/>{</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_scanPerpheralFailure((SEScanError)central.state);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[central<sp/>scanForPeripheralsWithServices:nil<sp/>options:nil];</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="420"><highlight class="normal">}</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal">-<sp/>(void)centralManager:(CBCentralManager<sp/>*)central<sp/>didDiscoverPeripheral:(CBPeripheral<sp/>*)peripheral<sp/>advertisementData:(NSDictionary&lt;NSString<sp/>*,<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">&gt;<sp/>*)advertisementData<sp/>RSSI:(NSNumber<sp/>*)RSSI</highlight></codeline>
<codeline lineno="423"><highlight class="normal">{</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(peripheral.name.length<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>;</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_perpherals.count<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_perpherals<sp/>addObject:peripheral];</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BOOL<sp/>isExist<sp/>=<sp/>NO;</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>_perpherals.count;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CBPeripheral<sp/>*per<sp/>=<sp/>[_perpherals<sp/>objectAtIndex:i];</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>([per.identifier.UUIDString<sp/>isEqualToString:peripheral.identifier.UUIDString])<sp/>{</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>isExist<sp/>=<sp/>YES;</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_perpherals<sp/>replaceObjectAtIndex:i<sp/>withObject:peripheral];</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!isExist)<sp/>{</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_perpherals<sp/>addObject:peripheral];</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_delegate<sp/>&amp;&amp;<sp/>[_delegate<sp/>respondsToSelector:</highlight><highlight class="keyword">@selector</highlight><highlight class="normal">(printerManager:perpherals:isTimeout:)])<sp/>{</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_delegate<sp/>printerManager:self<sp/>perpherals:_perpherals<sp/>isTimeout:NO];</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_scanPerpheralSuccess)<sp/>{</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_scanPerpheralSuccess(_perpherals,NO);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_autoConnect)<sp/>{</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSString<sp/>*UUIDString<sp/>=<sp/>[<ref refid="class_s_e_printer_manager" kindref="compound">SEPrinterManager</ref><sp/><ref refid="class_s_e_printer_manager_1af684d1409f68a8a2bd3a609dbc7c66ae" kindref="member">UUIDStringForLastPeripheral</ref>];</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>([peripheral.identifier.UUIDString<sp/>isEqualToString:UUIDString])<sp/>{</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_centralManager<sp/>connectPeripheral:peripheral<sp/>options:nil];</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>peripheral.delegate<sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="460"><highlight class="normal">}</highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>mark<sp/>----------------<sp/>连接外设成功和失败的代理<sp/>---------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal">-<sp/>(void)centralManager:(CBCentralManager<sp/>*)central<sp/>didConnectPeripheral:(CBPeripheral<sp/>*)peripheral</highlight></codeline>
<codeline lineno="464"><highlight class="normal">{</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/>_connectedPerpheral<sp/>=<sp/>peripheral;</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>NSUserDefaults<sp/>*userDefaults<sp/>=<sp/>[NSUserDefaults<sp/>standardUserDefaults];</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/>[userDefaults<sp/>setObject:peripheral.identifier.UUIDString<sp/>forKey:@&quot;peripheral&quot;];</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/>[userDefaults<sp/>synchronize];</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>[_centralManager<sp/>stopScan];</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_connectCompletion)<sp/>{</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_connectCompletion(peripheral,nil);</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_optionCompletion)<sp/>{</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_optionCompletion(SEOptionStageConnection,peripheral,nil);</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_delegate<sp/>&amp;&amp;<sp/>[_delegate<sp/>respondsToSelector:</highlight><highlight class="keyword">@selector</highlight><highlight class="normal">(printerManager:completeConnectPerpheral:error:)])<sp/>{</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_delegate<sp/>printerManager:self<sp/>completeConnectPerpheral:peripheral<sp/>error:nil];</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/>peripheral.delegate<sp/>=<sp/></highlight><highlight class="keyword">self</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/>[peripheral<sp/>discoverServices:nil];</highlight></codeline>
<codeline lineno="487"><highlight class="normal">}</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal">-<sp/>(void)centralManager:(CBCentralManager<sp/>*)central<sp/>didFailToConnectPeripheral:(CBPeripheral<sp/>*)peripheral<sp/>error:(<ref refid="_c_a_shape_layer_09_u_i_bezier_path_8h_1a02648067ad66739ed70a10195891098a" kindref="member">nullable</ref><sp/>NSError<sp/>*)error</highlight></codeline>
<codeline lineno="490"><highlight class="normal">{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_connectCompletion)<sp/>{</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_connectCompletion(peripheral,error);</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_optionCompletion)<sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_optionCompletion(SEOptionStageConnection,<sp/>peripheral,error);</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_delegate<sp/>&amp;&amp;<sp/>[_delegate<sp/>respondsToSelector:</highlight><highlight class="keyword">@selector</highlight><highlight class="normal">(printerManager:completeConnectPerpheral:error:)])<sp/>{</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_delegate<sp/>printerManager:self<sp/>completeConnectPerpheral:peripheral<sp/>error:error];</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="502"><highlight class="normal">}</highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal">-<sp/>(void)centralManager:(CBCentralManager<sp/>*)central<sp/>didDisconnectPeripheral:(CBPeripheral<sp/>*)peripheral<sp/>error:(<ref refid="_c_a_shape_layer_09_u_i_bezier_path_8h_1a02648067ad66739ed70a10195891098a" kindref="member">nullable</ref><sp/>NSError<sp/>*)error</highlight></codeline>
<codeline lineno="505"><highlight class="normal">{</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/>_connectedPerpheral<sp/>=<sp/>nil;</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/>[_writeChatacters<sp/>removeAllObjects];</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_delegate<sp/>&amp;&amp;<sp/>[_delegate<sp/>respondsToSelector:</highlight><highlight class="keyword">@selector</highlight><highlight class="normal">(printerManager:disConnectPeripheral:error:)])<sp/>{</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_delegate<sp/>printerManager:self<sp/>disConnectPeripheral:peripheral<sp/>error:error];</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_disconnectBlock)<sp/>{</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_disconnectBlock(peripheral,error);</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="516"><highlight class="normal">}</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>mark<sp/>----------------<sp/>发现服务的代理<sp/>-----------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal">-<sp/>(void)peripheral:(CBPeripheral<sp/>*)peripheral<sp/>didDiscoverServices:(<ref refid="_c_a_shape_layer_09_u_i_bezier_path_8h_1a02648067ad66739ed70a10195891098a" kindref="member">nullable</ref><sp/>NSError<sp/>*)error</highlight></codeline>
<codeline lineno="520"><highlight class="normal">{</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(error)<sp/>{</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_optionCompletion)<sp/>{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_optionCompletion(SEOptionStageSeekServices,peripheral,error);</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(CBService<sp/>*service<sp/>in<sp/>peripheral.services)<sp/>{</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[peripheral<sp/>discoverCharacteristics:nil<sp/>forService:service];</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_optionCompletion)<sp/>{</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_optionCompletion(SEOptionStageSeekServices,peripheral,nil);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal">}</highlight></codeline>
<codeline lineno="535"><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>mark<sp/>----------------<sp/>服务特性的代理<sp/>--------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal">-<sp/>(void)peripheral:(CBPeripheral<sp/>*)peripheral<sp/>didDiscoverCharacteristicsForService:(CBService<sp/>*)service<sp/>error:(<ref refid="_c_a_shape_layer_09_u_i_bezier_path_8h_1a02648067ad66739ed70a10195891098a" kindref="member">nullable</ref><sp/>NSError<sp/>*)error</highlight></codeline>
<codeline lineno="538"><highlight class="normal">{</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(error)<sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>([service<sp/>isEqual:peripheral.services.lastObject])<sp/>{</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(_writeChatacters.count<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_optionCompletion(SEOptionStageSeekCharacteristics,peripheral,nil);</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_optionCompletion(SEOptionStageSeekCharacteristics,peripheral,error);</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(CBCharacteristic<sp/>*character<sp/>in<sp/>service.characteristics)<sp/>{</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CBCharacteristicProperties<sp/>properties<sp/>=<sp/>character.properties;</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(properties<sp/>&amp;<sp/>CBCharacteristicPropertyWriteWithoutResponse)<sp/>{</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSDictionary<sp/>*dict<sp/>=<sp/>@{<ref refid="_s_e_printer_manager_8m_1a059728dbdb3a9360cf3307e75d3296d5" kindref="member">kSECharacter</ref>:character,<ref refid="_s_e_printer_manager_8m_1a00e77f56ab5fdd804c8e8fa85013e1b5" kindref="member">kSEType</ref>:@(CBCharacteristicWriteWithoutResponse)};</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_writeChatacters<sp/>addObject:dict];</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(properties<sp/>&amp;<sp/>CBCharacteristicPropertyWrite)<sp/>{</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NSDictionary<sp/>*dict<sp/>=<sp/>@{<ref refid="_s_e_printer_manager_8m_1a059728dbdb3a9360cf3307e75d3296d5" kindref="member">kSECharacter</ref>:character,<ref refid="_s_e_printer_manager_8m_1a00e77f56ab5fdd804c8e8fa85013e1b5" kindref="member">kSEType</ref>:@(CBCharacteristicWriteWithResponse)};</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[_writeChatacters<sp/>addObject:dict];</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>([service<sp/>isEqual:peripheral.services.lastObject])<sp/>{</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_optionCompletion(SEOptionStageSeekCharacteristics,peripheral,nil);</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="566"><highlight class="normal">}</highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight><highlight class="keyword">@end</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/Users/suxinde/XDCommonLib/XDCommonLib/BLLSDKLayer/BLE/BLEPrinter/SEPrinterManager.m"/>
  </compounddef>
</doxygen>
